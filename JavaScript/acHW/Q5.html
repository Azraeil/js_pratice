<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>JS ToDoList</title>
  <script>
    function createToDo() {
      console.log("===============");
      // ToDo 基本元素標籤
      // 創造 toDoList div
      var divToDo = document.createElement("div");

      // 創造 新增待辦事項的標籤
      var spanToDo = document.createElement("span");

      // 創造 新增待辦事項的取代輸入文字按鈕
      var replaceButton = document.createElement("button");

      // 創造 新增待辦事項的完成(刪除)按鈕
      var removeButton = document.createElement("button");

      // 處理 spanToDo 文字內容
      var input = document.getElementById("input").value;
      if (input === "") {
        input = "No input.";
        return ;
      }
      spanToDo.innerHTML = input;

      // 處理 spanToDo 顏色(ToDo優先程度)
      var stateToDo = document.getElementById("myRadio1");

      if (stateToDo.checked === true) {
        divToDo.style.color = "red";
      }
      else {
        divToDo.style.color = "green";
      }

      // 設定 replaceButton 事件
      replaceButton.onclick = function() {
        var input = document.getElementById("input").value;
        if (input === "") {
          alert("您並沒有輸入任何文字");
          return;
        }

        this.parentNode.firstChild.innerHTML = input;
        // 把 input 欄位的值設定好之後清除 input 欄位
        document.getElementById("input").value = "";
      }

      replaceButton.textContent = "Replace";

      // 設定 removeButton 事件
      removeButton.onclick = function() {
        // this.parentNode = 包在外圍的 divToDo
        console.log(this.parentNode);
        // this.parentNode.parentNode = div class id="toDoList"
        // 從這一層執行 removeChild 刪除指定的 div
        console.log(this.parentNode.parentNode);

        var check = window.confirm("是否確定完成？");
        if (check) {
          var remove = this.parentNode.parentNode.removeChild(document.getElementById("toDoButtons"));

          divToDo.style.color = "blue";
        }
        else {
          return ;
        }

      }

      removeButton.textContent = "V";

      // 加入 div (外圍)
      // span button button
      var addToDo = document.getElementById("toDoList");
      addToDo.appendChild(divToDo);
      divToDo.appendChild(spanToDo);
      // 把兩個按鈕包起來比較好刪除
      var spanButtons = document.createElement("span");
      spanButtons.id = "toDoButtons";
      divToDo.appendChild(spanButtons);
      spanButtons.appendChild(replaceButton);
      spanButtons.appendChild(removeButton);
    }

  </script>
</head>

<body>
  <form>
    <input type="text" id="input" value="">
    <input type="radio" name="state" id="myRadio1"> 緊急
    <input type="radio" name="state" id="myRadio2"> 不緊急
  </form>

  <button onclick="createToDo()"> + </button>

  <div class="" id="toDoList">
    ToDoList :
  </div>
</body>

</html>
